# Dealabs Api Notifications

[![Tests](https://github.com/thomasync/dealabs-api-notifications/actions/workflows/python-package.yml/badge.svg)](https://github.com/thomasync/dealabs-api-notifications/actions/workflows/python-package.yml)

## Envoi des notifications sur t√©l√©phone pour les erreurs de prix Dealabs (via pushover)

1. Cr√©er un compte sur [PushOver](https://pushover.net/)
2. G√©n√©rer une [application](https://pushover.net/apps/build)
3. Renommer le fichier **.env.example** en **.env**
4. Remplir les valeurs _PUSHOVER_TOKEN_ et _PUSHOVER_USER_
5. Sur l'application : Settings -> Advanced Settings -> Auto-open URLs

Exemple de la commande:

```python
pip install -r requirements.txt

# python3 main.py [refresh_seconds] [minimum_discount] [free_products] [expire_notification] [open_dealabs] [priority_only_first] [free_products_priority]
python3 main.py 60 90 0 0 1 1 0
```

Optionnel dans le fichier .env:

- _REFRESH_SECONDS_ : Actualiser la recherche des deals toutes les x seconds (60s par d√©faut)
- _MIN_DISCOUNT_ : Repr√©sente le pourcentage minimum pour d√©clencher la notification (90% par d√©faut)
- _FREE_PRODUCTS_ : Capturer √©galement les produits gratuits (D√©sactiv√© par d√©faut)
- _EXPIRE_NOTIFICATION_ : Pr√©vient de l'expiration des tokens PushOver la veille pour les modifier (attention c'est bas√© sur la date de modification du fichier **.env**) (D√©sactiv√© par d√©faut)
- _OPEN_DEALABS_ : Au click sur la notification ouvrir Dealabs, au lieu du site du deal (Activ√© par d√©faut)
- _PRIORITY_ONLY_FIRST_ : Notifier uniquement en priorit√© a l'apparition du deal et pas √† chaque mise √† jour (Activ√© par d√©faut)
- _FREE_PRODUCTS_PRIORITY_ : Envoi √©galement les notifications des produits gratuit en priorit√© (D√©sactiv√© par d√©faut)

---

üö® Attention : **PushOver** n'est gratuit qu'un mois, il faut soit refaire un compte et changer les tokens une fois par mois, soit payer 5,99‚Ç¨ d√©finitivement.

---

## Utilisation de la librairie de fa√ßon ind√©pendante

1. D√©placer le dossier **dealabs** dans votre projet
2. Importer la classe Dealabs: `from dealabs import Dealabs`
3. Instanciez: `dealabs = Dealabs()`

### Exemples

#### R√©cuperer les deals avec au minimum 80% de r√©duction et sans les produits gratuits

```python
from dealabs import Dealabs
dealabs = Dealabs(80, 0)
deals = dealabs.getDeals()
```

#### R√©cuperer les deals avec au minimum 80% de r√©duction, avec les produits gratuits mais ne pas ajouter ceux en cours de mod√©ration

```python
from dealabs import Dealabs
dealabs = Dealabs(80, 1)
deals = dealabs.getDeals(False)
```

#### R√©cuper un deal depuis son id

```python
from dealabs import Dealabs
dealabs = Dealabs()
deal = dealabs.getDeal(2497616)
print(deal.json())
```

#### R√©cuper un deal depuis son url

```python
from dealabs import Dealabs
dealabs = Dealabs()
deal = dealabs.getDealFromUrl("2497616")
print(deal.json())
```

## [CHANGELOG](https://github.com/thomasync/dealabs-api-notifications/blob/main/CHANGELOG.MD)

2023 - [@thomasync](https://github.com/thomasync)
